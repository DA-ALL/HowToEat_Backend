{
  "function_score": {
    "query": {
      "bool": {
        "should": [
          { "constant_score": { "filter": { "term": { "foodName.keyword": "{{keyword}}" } }, "boost": 50 }},
          { "constant_score": { "filter": { "prefix": { "foodName.keyword": "{{keyword}}" } }, "boost": 30 }},
          { "match_phrase_prefix": { "foodName": { "query": "{{keyword}}", "analyzer": "nori", "max_expansions": 50 } }},
          { "match_phrase": { "foodName": { "query": "{{keyword}}", "analyzer": "nori" } }},
          { "match": { "foodName": { "query": "{{keyword}}", "analyzer": "nori" } }},

          { "constant_score": { "filter": { "term":   { "providedBy": "{{keyword}}" } }, "boost": 35 }},
          { "constant_score": { "filter": { "prefix": { "providedBy": "{{keyword}}" } }, "boost": 20 }},
          { "match_phrase":        { "providedBy.text": { "query": "{{keyword}}" } }},
          { "match":               { "providedBy.auto": { "query": "{{keyword}}" } }}
        ],
        "minimum_should_match": 1
      }
    },
    "functions": [
      { "filter": { "term": { "foodType": "COOKED" } }, "weight": 3 },
      { "filter": { "term": { "foodType": "PROCESSED" } }, "weight": 2 },
      { "filter": { "term": { "source": "Admin-Verified" } }, "weight": 2 },
      { "field_value_factor": { "field": "selectedCount", "factor": 0.1, "modifier": "log1p", "missing": 0 } },
      { "filter": { "term": { "isPerServing": true } }, "weight": 1.5 }
    ],
    "score_mode": "sum",
    "boost_mode": "sum"
  }
}